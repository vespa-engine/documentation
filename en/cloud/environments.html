---
# Copyright Vespa.ai. All rights reserved.
title: Environments
category: cloud
---

<p>Vespa Cloud has two kinds of environments:</p>
<ul>
  <li>Manual environment for rapid development and test: <code>dev</code></li>
  <li>Automated environment with integrated CD pipeline: <code>prod</code></li>
</ul>
<p>
  An application is deployed to one or more <em>zones</em> (see <a href="/en/cloud/zones.html">zone list</a>),
  which is a combination of an <em>environment</em> and a <em>region</em>, like
  <code>vespa deploy -z dev.aws-us-east-1c</code>.
</p>


<h2 id="dev">Dev</h2>
<p>
  The dev environment is built for rapid developments cycles,
  with auto-downscaling and auto-expiry for ease of use and cost control.
  The dev environment is the default, to deploy to this, use <code>vespa deploy</code>.
</p>


<h3 id="auto-downscaling">Auto downscaling</h3>
<p>
  One use case for the dev environment is to take an application package from a prod environment
  and deploy to the dev environment to debug.
  To minimize cost and make this speedy,
  Vespa Cloud will by default ignore <a href="/en/reference/services.html#nodes">nodes</a> and
  <a href="/en/reference/services.html#resources">resources</a> settings.
</p>
<p>With this, you can safely download an application package from prod (that are normally large) and deploy to dev, with no changes.</p>
<p>
  To override this behavior and control the resources,
  specify them explicitly for the dev environment
  as described in <a href="/en/reference/deployment-variants.html#services.xml-variants">deployment variants</a>.
  Example:
</p>
<pre>{% highlight xml %}
<content version="1.0">
    <nodes deploy:environment="dev"
           count="1" />
    <nodes deploy:environment="prod"
           deploy:region="aws-us-east-1c"
           count="20">
        <resources vcpu="16.0" memory="128Gb" disk="3750Gb"/>
    </nodes>
</content>>
{% endhighlight %}</pre>
{% include important.html content='The <code>dev</code> environment has redundancy 1 by default,
and there are no availability or data persistence guarantees.
Do not use applications deployed to these zones for production serving use cases.' %}


<h3 id="auto-expiry">Auto expiry</h3>
<p>
  Deployments to <code>dev</code> expire after 14 days of inactivity,
  that is, 14 days after the last <a href="/en/applications.html#deploying-applications">deployment</a>.
  <strong>This applies to all plans</strong>.
  To add 7 more days to the expiry period, redeploy the application or use the Vespa Cloud Console.
</p>


<h3 id="vespa-version">Vespa version</h3>
<p>
  The latest active Vespa version is used when deploying to the dev environment.
  The deployment is upgraded at a time which is most likely at night for the developer in order to minimize downtime
  (based on the time when last deployments were made).
  An upgrade will be skipped if metrics indicate ongoing feed or query load,
  but will still be done if current version is more than a week old.
</p>



<h2 id="prod">Prod</h2>
<p>
  Applications are deployed to the <code>prod</code> environment for production serving.
  Deployments are passed through an integrated CD pipeline for system tests and staging tests.
  Read more in <a href="/en/cloud/automated-deployments.html">automated deployments</a>.
</p>



<h2 id="test">Test</h2>
<p>
  The <code>test</code> environment is used by the integrated CD pipeline for prod deployments,
  to run <a href="/en/cloud/automated-deployments.html#system-tests">system tests</a>.
  The test capacity is ephemeral and only used during test.
  Nodes in test and staging environments do not have access to data in prod environments.
<p>
  Note that one cannot deploy directly to test and staging environments.
  For long-lived test applications (e.g., a QA system that is integrated with other services) use the prod environment.
</p>
<p>
  System tests are always invoked, even if there are no tests defined.
  In this case, an instance is just started and then stopped.
  This has value in itself, as it ensures that the application is able to start.
</p>
<p>
  Test runs can be <a href="/en/cloud/automated-deployments.html#disabling-tests">aborted</a>.
</p>



<h2 id="staging">Staging</h2>
<p>
  See system tests above, this applies to the staging, too.
  <a href="/en/cloud/automated-deployments.html#staging-tests">Staging tests</a>
  use a fraction of the configured prod capacity, this can be overridden to using 1 node regardless of prod cluster size:
</p>
<pre>{% highlight xml %}
<content version="1.0">
    <nodes deploy:environment="staging" count="1">
        <resources vcpu="2.0" memory="8Gb" disk="50Gb"/>
    </nodes>
</content>
{% endhighlight %}</pre>



<h2 id="reference">Reference</h2>
<p>Environment settings:</p>
<table class="table">
  <thead>
  <tr><th style="width:100px">Name</th><th>Description</th><th>Expiry</th><th>Cluster sizes</th></tr>
  </thead>
  <tbody>
  <tr>
    <td id="dev-reference"><code>dev</code></td>
    <td>Used for manual development testing.</td>
    <td>14 days</td>
    <td><code>1</code></td>
  </tr><tr>
    <td id="test-reference"><code>test</code></td>
    <td>Used for <a href="/en/testing.html#system-tests">automated system tests</a>.</td>
    <td>-</td>
    <td><code>1</code></td>
  </tr><tr>
    <td id="staging-reference"><code>staging</code></td>
    <td>Used for <a href="/en/testing.html#staging-tests">automated staging tests</a>.</td>
    <td>-</td>
    <td><code>min(max(2, 0.05 * spec), spec)</code></td>
  </tr><tr>
    <td id="prod-reference"><code>prod</code></td>
    <td>Hosts all production deployments.</td>
    <td>No expiry</td>
    <td><code>max(2, spec)</code></td>
  </tr>
  </tbody>
</table>

