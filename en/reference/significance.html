---
# Copyright Vespa.ai. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.
title: "Significance Model Reference"
redirect_from:
- /documentation/reference/significance.html
---
<p>
The
<a href="rank-features.html#significance">significance model feature</a>
implements the <a href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf#Inverse_document_frequency">inverse document frequency</a> query term for tokens based on an existing or user defined significance model. A siginficance model is a mapping from query terms to a floating point value. The significance model(s) are either provided by Vespa or can be generated using the Vespa-CLI command <a href="../operations-selfhosted/vespa-cmdline-tools.html#vepsa-signficance"><em>vespa-significance</em></a>. 

<h2>Background</h2>
The <a href="bm25.html">bm25 rank feature</a> uses the inverse document frequency (IDF) of each query term searching an index field when calculating the score of a document:

<figure style="font-size: 1.2rem">
  <div>
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <semantics>
        <mrow>
          <munderover>
            <mo>&Sum;</mo>
            <mi>i</mi>
            <mi>n</mi>
          </munderover>
          <mi>I</mi>
          <mi>D</mi>
          <mi>F</mi>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>q</mi>
              <mi>i</mi>
            </msub>
            <mo>)</mo>
          </mrow>
          <mo>&#x22C5;<!--MULTIPLICATION SIGN--></mo>
          <mfrac>
            <mrow>
              <mi>f</mi>
              <mo>(</mo>
              <msub>
                <mi>q</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <mi>D</mi>
              <mo>)</mo>
              <mo>&#x22C5;<!--MULTIPLICATION SIGN--></mo>
              <mo>(</mo>
              <msub>
                <mi>k</mi>
                <mn>1</mn>
              </msub>
              <mo>+</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
            <mrow>
              <mi>f</mi>
              <mo stretchy="false">(</mo>
              <msub>
                <mi>q</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <mi>D</mi>
              <mo stretchy="false">)</mo>
              <mo>+</mo>
              <msub>
                <mi>k</mi>
                <mn>1</mn>
              </msub>
              <mo>&#x22C5;<!--MULTIPLICATION SIGN--></mo>
              <mo>(</mo>
              <mn>1</mn>
              <mo>-</mo>
              <mi>b</mi>
              <mo>+</mo>
              <mi>b</mi>
              <mo>&#x22C5;<!--MULTIPLICATION SIGN--></mo>
              <mfrac>
                <mrow>
                  <mi>f</mi>
                  <mi>i</mi>
                  <mi>e</mi>
                  <mi>l</mi>
                  <mi>d</mi>
                  <mi>_</mi>
                  <mi>l</mi>
                  <mi>e</mi>
                  <mi>n</mi>
                </mrow>
                <mrow>
                  <mi>a</mi>
                  <mi>v</mi>
                  <mi>g</mi>
                  <mi>_</mi>
                  <mi>f</mi>
                  <mi>i</mi>
                  <mi>e</mi>
                  <mi>l</mi>
                  <mi>d</mi>
                  <mi>_</mi>
                  <mi>l</mi>
                  <mi>e</mi>
                  <mi>n</mi>
                </mrow>
              </mfrac>
              <mo>)</mo>
            </mrow>
          </mfrac>
        </mrow>
      </semantics>
    </math>
  </div>
</figure>

<p>The IDF of query term i in field t is currently calculated <strong>per field per content node:</strong></p>
<figure style="font-size: 1.2rem">
  <div>
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
      <semantics>
        <mrow>
          <mi>l</mi>
          <mi>o</mi>
          <mi>g</mi>
          <mo>(</mo>
          <mn>1</mn>
          <mo>+</mo>
          <mfrac>
            <mrow>
              <mi>N</mi>
              <mo>-</mo>
              <mi>n</mi>
              <mo>(</mo>
              <msub>
                <mi>q</mi>
                <mi>i</mi>
              </msub>
              <mo>)</mo>
              <mo>+</mo>
              <mn>0.5</mn>
            </mrow>
            <mrow>
              <mi>n</mi>
              <mo>(</mo>
              <msub>
                <mi>q</mi>
                <mi>i</mi>
              </msub>
              <mo>)</mo>
              <mo>+</mo>
              <mn>0.5</mn>
            </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
      </semantics>
    </math>
  </div>
</figure>

<p>
  <strong>N</strong> is the total number of documents on the content node, and <strong>n(q<sub>i</sub>)</strong> is the number of documents containing the query term <strong>q<sub>i</sub></strong> for field <strong>t</strong>.
</p>

<h3>Short commings:</h3>
<ul>
  <li>The IDF values will typically be different across content nodes, as they contain a different subset of the document corpus. This might lead to inconsistent ranking order between content nodes.</li>
  <li>When using bm25 in <a href="../streaming-search.html" >streaming search</a> no IDF values are available at all, as we donâ€™t build an inverted index where the IDF values can be extracted from</li>
</ul>

<p>With the user or Vepsa defined significance models, the IDF calculation can be overridden</p>

<h2 id="example">Example</h2>
<p>
In the following example, we show how to reference a significance model in the <code>service.xml</code>. 
Note that the field must be enabled for usage with the bm25 feature
by setting the <em>use-model</em> flag in the
<a href="schema-reference.html#index">significance</a> rank-profile 
section of the field definition.
</p>

<p>
<pre data-test="file" data-path="my-app/src/main/application/services.xml">
&lt;container version="1.0"&gt;
    &lt;search&gt;
        &lt;significance&gt;  	
            &lt;model model-id="wikimedia"/&gt;
            &lt;model url="https://some/uri/bibel-multilingual.json" /&gt;
            &lt;model path="models/reddit-norge.no.json.zst" /&gt;
        &lt;/significance&gt;
    &lt;/search&gt;
&lt;/container&gt;      
</pre>
</p>

Note that it is possible to specify multiple significance models in the <code>service.xml</code> file.

<p>
<pre>
schema example {
  document example {
    field content type string {
      indexing: index | summary
      index: enable-bm25
    }
  }
  rank-profile default {
    significance {
      use-model: true
    }
  }
}
</pre>
</p>

