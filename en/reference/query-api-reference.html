---
# Copyright Yahoo. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.
title: "Query API Reference"
redirect_from:
- /documentation/reference/query-api-reference.html
---

<p>
All the request parameters listed below can be set in query profiles.
The first four blocks of properties are also modeled as
<a href="../query-profiles.html#query-profile-types">query profile types</a>.
These types can be referred from query profiles (and inheriting types)
to provide type checking on the parameters.
</p><p>
These parameters often have both a full name -
including the path from the root query profile -
and one or more abbreviated names.
Both names can be used in requests,
while only full names can be used in query profiles.
The full names are case-sensitive, abbreviated names are case-insensitive.
</p><p>
The parameters modeled as query profiles are also available through
get methods as Java objects from the Query to Searcher components.
</p>



<h2 id="parameters">Parameters</h2>
<dl>
<dt>Query</dt>
<dd>
  <ul>
    <li><a href="#yql">yql</a></li>
    <li><a href="#select">select</a>
    	<ul>
    		<li><a href="#where">where</a></li>
    		<li><a href="#grouping">grouping</a></li>
    	</ul>
    </li>
  </ul>
</dd>

<dt>Native Execution Parameters</dt>
<dd>
  <ul>
    <li><a href="#hits">hits</a> [<em>count</em>]</li>
    <li><a href="#offset">offset </a>[<em>start</em>]</li>
    <li><a href="#queryProfile">queryProfile</a></li>
    <li><a href="#groupingSessionCache">groupingSessionCache</a></li>
    <li><a href="#searchChain">searchChain</a></li>
    <li><a href="#timeout">timeout</a></li>
    <li><a href="#tracelevel">tracelevel</a></li>
    <li><a href="#explainlevel">explainlevel</a></li>
    <li><a href="#trace.timestamps">trace.timestamps</a></li>
  </ul>
</dd>

<dt>Query Model Parameters</dt>
<dd>
  <ul>
    <li><a href="#model.defaultIndex">model.defaultIndex</a> [<em>default-index</em>]</li>
    <li><a href="#model.encoding">model.encoding</a> [<em>encoding</em>]</li>
    <li><a href="#model.filter">model.filter</a> [<em>filter</em>]</li>
    <li><a href="#model.locale">model.locale</a> [<em>locale</em>]</li>
    <li><a href="#model.language">model.language</a> [<em>lang, language</em>]</li>
    <li><a href="#model.querystring">model.queryString</a> [<em>query</em>]</li>
    <li><a href="#model.restrict">model.restrict</a> [<em>restrict</em>]</li>
    <li><a href="#model.searchPath">model.searchPath</a> [<em>path</em>]</li>
    <li><a href="#model.sources">model.sources</a> [<em>search, sources</em>]</li>
   <li><a href="#model.type">model.type</a> [<em>type</em>]</li>
  </ul>
</dd>

<dt>Ranking</dt>
<dd>
  <ul>
    <li><a href="#ranking.location">ranking.location</a> [<em>location</em>]</li>
    <li><a href="#ranking.features">ranking.features</a> [<em>rankfeature</em>]</li>
    <li><a href="#ranking.listFeatures">ranking.listFeatures</a> [<em>rankfeatures</em>]</li>
    <li><a href="#ranking.profile">ranking.profile</a> [<em>ranking</em>]</li>
    <li><a href="#ranking.properties">ranking.properties</a> [<em>rankproperty</em>]</li>
    <li><a href="#ranking.softtimeout">ranking.softtimeout</a></li>
    <li><a href="#ranking.sorting">ranking.sorting</a> [<em>sorting</em>]</li>
    <li><a href="#ranking.freshness">ranking.freshness</a></li>
    <li><a href="#ranking.queryCache">ranking.queryCache</a></li>
    <li><a href="#ranking.rerankCount">ranking.rerankCount</a></li>
    <li><a href="#ranking.matchPhase">ranking.matchPhase</a></li>
  </ul>
</dd>

<dt>Presentation</dt>
<dd>
  <ul>
    <li><a href="#presentation.bolding">presentation.bolding</a> [<em>bolding</em>]</li>
    <li><a href="#presentation.format">presentation.format</a> [<em>format</em>]</li>
    <li><a href="#presentation.template">presentation.template</a></li>
    <li><a href="#presentation.summary">presentation.summary</a> [<em>summary</em>]</li>
    <li><a href="#presentation.timing">presentation.timing</a></li>
  </ul>
</dd>

<dt>Grouping</dt>
<dd>
  <ul>
    <li><a href="#grouping-select">select</a></li>
    <li><a href="#collapse.summary">collapse.summary</a></li>
    <li><a href="#collapsefield">collapsefield</a></li>
    <li><a href="#collapsesize">collapsesize</a></li>
  </ul>
</dd>

<dt><a href="#geographical-searches">Geographical Searches</a></dt>
<dd>
  <ul>
    <li><a href="#pos.ll">pos.ll</a></li>
    <li><a href="#pos.radius">pos.radius</a>,</li>
    <li><a href="#pos.attribute">pos.attribute</a></li>
    <li><a href="#pos.bb">pos.bb</a></li>
  </ul>
</dd>

<dt>Semantic Rules</dt>
<dd>
  <ul>
    <li><a href="#rules.off">rules.off</a></li>
    <li><a href="#rules.rulebase">rules.rulebase</a></li>
    <li><a href="#tracelevel.rules">tracelevel.rules</a></li>
  </ul>
</dd>

<dt>Dispatch</dt>
<dd>
  <ul>
    <li><a href="#dispatch.topKProbability">dispatch.topKProbability</a></li>
  </ul>
</dd>

<dt>Other</dt>
<dd>
  <ul>
    <li><a href="#recall">recall</a></li>
    <li><a href="#user">user</a></li>
    <li><a href="#hitcountestimate">hitcountestimate</a></li>
    <li><a href="#metrics.ignore">metrics.ignore</a></li>
    <li><a href="#weakAnd.replace">weakAnd.replace</a></li>
    <li><a href="#wand.hits">wand.hits</a></li>
  </ul>
</dd>
</dl>



<h2 id="http-status-codes">HTTP status codes</h2>
<p>
The status code rules are:
</p>
<ul>
  <li>
    If the Result contains no errors (Result.hits().getError()==null): 200 OK is returned.
  </li><li>
    If the Result contains errors and no regular hits:
    <ul>
      <li>
        If the error code of any ErrorMessage in the Result
        (Result.hits().getErrorHit().errorIterator()) is a "WEB SERVICE ERROR CODE",
        the first of those is returned.
      </li><li>
        Otherwise, if it is an "HTTP COMPATIBLE ERROR CODE",
        the mapping of it is returned.
      </li><li>
        Otherwise 500 INTERNAL_SERVER_ERROR is returned.
      </li>
    </ul>
  </li><li>
    If the Result contains errors and also contains valid hits:
    The same as above, but 200 OK is returned by default instead of 500.
  </li>
</ul>
WEB SERVICE ERROR CODES:
<pre>
200, 301, 302, 307, 400, 401, 403, 404, 405, 406, 408, 428, 429, 431, 500, 501, 502, 511
</pre>
HTTP COMPATIBLE ERROR CODES:
<pre>
com.yahoo.container.protect.Error.BAD_REQUEST -&gt; Http code 400
com.yahoo.container.protect.Error.UNAUTHORIZED -&gt; Http code 401
com.yahoo.container.protect.Error.FORBIDDEN -&gt; Http code 403
com.yahoo.container.protect.Error.NOT_FOUND -&gt; Http code 404
com.yahoo.container.protect.Error.INTERNAL_SERVER_ERROR -&gt; Http code 500
com.yahoo.container.protect.Error.INSUFFICIENT_STORAGE -&gt; Http code 507
</pre>




<h2 id="query">Query</h2>
<h3 id="yql">yql</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>String. The <a href="../query-language.html">YQL query</a>
        to be parsed and executed.</td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>


<h3 id="select">select</h3>
<p>Select query is equivalent to YQL, written in JSON.
Contains subparameters <code>where</code> and <code>grouping</code>.</p>

<h4 id="where"> where</h4>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>JSON</td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>

<h4 id="grouping"> grouping</h4>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>JSON</td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>
<p>
The where and grouping query will be parsed and executed in the backend.
Refer to
<a href="../reference/select-reference.html">Select Reference</a> for details.
</p>



<h2 id="native-execution-parameters">Native Execution Parameters</h2>
<p>
These parameters are defined in the <code>native</code> query profile type.
</p>


<h3 id="hits">hits</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>count</td></tr>
<tr><td>Values</td>
    <td>
      A positive integer, or 0. The sum of <a href="#offset">offset</a> and
      <a href="#hits">hits</a> should be lower than the configured maxoffset
      value, and will be adjusted to fit. See also comment
      at <code>offset</code>.
    </td>
</tr>
<tr><td>Default</td><td>10</td></tr>
</table>
<p>
The maximum number of hits to return from the result set.
Must be lower than <code>maxHits</code>, which is either set in a
<a href="#queryProfile">query profile</a>, or default 400.
<!-- ToDo: link to def file or code where this is defined -->
</p>


<h3 id="offset">offset</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td>start</td></tr>
  <tr><td>Values</td>
    <td>
      A positive integer, including 0.
    </td>
  </tr>
  <tr><td>Default</td><td>0</td></tr>
</table>
<p>
The index of the first hit to return from the result set.
Must be lower than <code>maxOffset</code>, which is either set in a
<a href="#queryProfile">query profile</a>, or default 1000.
<!-- ToDo: link to def file or code where this is defined -->
</p>


<h3 id="queryProfile">queryProfile</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td><em>None</em></td></tr>
  <tr><td>Values</td>
    <td>
      A query profile id  -  name:version, where version can be omitted
      or partially specified, e.g "myprofile:2.1"
    </td>
  </tr>
  <tr><td>Default</td><td><code>default</code></td></tr>
</table>
<p>
A <a href="../query-profiles.html">query profile</a> has default properties for a query.
The default query profile is named <em>default</em> - example:
</p>
<pre>
&lt;query-profile id="default"&gt;
  &lt;field name="maxHits"&gt;10&lt;/field&gt;
  &lt;field name="maxOffset"&gt;1000&lt;/field&gt;
&lt;/query-profile&gt;
</pre>


<h3 id="groupingSessionCache">groupingSessionCache</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>
      True or false
    </td>
</tr>
<tr><td>Default</td><td>true</td></tr>
</table>
<p>
Set to true to store intermediate grouping results in the content nodes
when using multi level grouping expressions,
in order to speed up grouping at a potential loss of accuracy.
This causes the query and grouping expression to be run only once.
</p><p>
When having multi-level grouping expressions, the search query is normally re-run for each level.
The drawback of this is, with an expensive ranking function,
the query will take more time than strictly necessary.
</p>
{% include important.html content="The flag is <strong>only useful if</strong> the grouping expression
does not have a <code>order()</code> clause.
The <strong>drawback</strong> of using this flag is that when <code>max()</code>
is specified in the grouping expression,
it might cause inaccuracies in aggregated values such as <code>count()</code>.
It is hence recommended testing whether this is an issue or not,
and if so, adjust the <code>precision</code> parameter to still get correct counts."%}


<h3 id="searchChain">searchChain</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>
      A search chain id  -  name:version, where version can be
      omitted or partially specified, e.g "mychain:2.1.3".
    </td>
</tr>
<tr><td>Default</td><td><code>default</code></td></tr>
</table>
<p>
The <a href="../chained-components.html">search chain</a> initially invoked when processing the query.
This search chain may invoke other chains.
</p>


<h3 id="timeout">timeout</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>
      Positive floating point number with an optional unit. Default unit
      is seconds (s), valid unit strings are e.g. <em>ms</em> and <em>s</em>. To set
      a timeout of one minute, the argument could be set to <em>60 s</em>.
      Space between the number and the unit is optional.
    </td>
</tr>
<tr><td>Default</td><td>500 milliseconds.
</table>
<p>
The query timeout, returning 0 hits in the result set.
To return hits at timeout, refer to <a href="#ranking.softtimeout">ranking.softtimeout</a>
</p>


<h3 id="tracelevel">tracelevel</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>
      Any positive number. Tracing is subject to change at any time, the below is a guide:
      <table class="table">
        <tr><td>1</td><td>Basic tracing in container</td></tr>
        <tr><td>2</td><td>Basic tracing, more details</td></tr>
        <tr><td>3</td><td>Basic tracing, even more details</td></tr>
        <tr><td>4</td><td>Include timing info from backend</td></tr>
        <tr><td>5</td><td>More timing info from backend</td></tr>
        <tr><td>6</td><td>Include query blueprint</td></tr>
        <tr><td>7</td><td>Include query execution tree</td></tr>
      </table>
    </td>
</tr>
<tr><td>Default</td><td><em>No tracing</em></td></tr>
</table>
<p>
Set to a positive number to collect trace information for debugging when running a query.
Higher numbers give progressively more detail on query transformations,
searcher execution and search backend execution.
</p>

<h3 id="explainlevel">explainlevel</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>
      Any positive number. Note that you might get the same at <a href="#tracelevel">tracelevel</a> 5 and above. Explanation is subject to change at any time, the below is a guide:
      <table class="table">
        <tr><td>1</td><td>Timing and overall query plan(blueprint) from each backend node</td></tr>
        <tr><td>2</td><td>Timing per search thread and execution tree(iterator tree)</td></tr>
      </table>
    </td>
</tr>
<tr><td>Default</td><td><em>No explanation</em></td></tr>
</table>
<p>
Set to a positive number to collect query execution information for debugging when running a query.
Higher numbers give progressively more detail on backend query execution. Must be combined with non-zero <a href="#tracelevel">tracelevel</a>.
</p>

<h3 id="trace.timestamps">trace.timestamps</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td>
    <td>
      true or false
    </td>
</tr>
<tr><td>Default</td><td><em>No timestamps in trace</em></td></tr>
</table>
<p>
Enable it to get timing information already at <a href="#tracelevel">tracelevel=1</a> which is useful for debugging latency spent at different components in the search chain without rendering a lot of string data which is associated with higher trace levels.
</p>



<h2 id="query-model">Query Model Parameters</h2>

<h3 id="model.defaultIndex">model.defaultIndex [<em>default-index</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>default-index</td></tr>
<tr><td>Values</td><td>An index name</td></tr>
<tr><td>Default</td><td><code>default</code></td></tr>
</table>
<p>
The field which is searched for query terms which doesn't explicitly specify an index.
</p>


<h3 id="model.encoding">model.encoding [<em>encoding</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>encoding</td></tr>
<tr><td>Values</td><td>Encoding names or aliases defined in the <a href="https://www.iana.org/assignments/character-sets">IANA character sets</a></td></tr>
<tr><td>Default</td><td>utf-8</td></tr>
</table>
<p> Sets the encoding to use when returning a result. The encodings <em>big5</em>,
<em>euc-jp</em>, <em>euc-kr</em>, <em>gb2312</em>, <em>iso-2022-jp</em> and <em>shift-jis</em>
also influences how <a href="../linguistics.html#tokenization">tokenization</a> is done
in the absence of an explicit language setting.
</p><p>
The query is always encoded as UTF-8, independently of how the result will be encoded.
</p>


<h3 id="model.filter">model.filter [<em>filter</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>filter</td></tr>
<tr><td>Values</td>
    <td>A filter string in the
<a href="simple-query-language-reference.html">Simple Query Language</a></td></tr>
<tr><td>Default</td><td><em>Not set</em></td></tr>
</table>
<p>
Sets a filter to be combined with the <a href="#model.querystring">model.queryString</a>.
Typical use of a filter is to add machine generated or preferences based filter terms
to the user query.
The filter is parsed the same way as a query of type <code>any</code>,
the full syntax is available.
The positive terms (preceded by +) and phrases act as AND filters,
the negative terms (preceded by -) act as NOT filters,
while the unprefixed terms will be used to RANK the results.
Unless the query has no positive terms,
the filter will only restrict and influence ranking of the result set,
never cause more matches than the query.
</p>


<h3 id="model.locale">model.locale [<em>locale</em>]</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td>locale</td></tr>
  <tr><td>Values</td><td>A language tag from <a href="https://tools.ietf.org/html/rfc5646">RFC 5646</a></td></tr>
  <tr><td>Default</td><td><em>Not set</em></td></tr>
</table>
<p>Sets the locale and language to use when parsing queries from a language tag, such as e.g "en-US".
This attribute should always be set when it is known. If this
parameter is not set, it will be guessed from the query and encoding, and
default to english if it cannot be guessed.
</p>


<h3 id="model.language">model.language [<em>lang, language</em>]</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td>language, lang</td></tr>
  <tr><td>Values</td><td>A language tag from <a href="https://tools.ietf.org/html/rfc5646">RFC 5646</a>,
    but allowing underscore instead of dash as separator character.</td></tr>
  <tr><td>Default</td><td><em>Unspecified</em></td></tr>
</table>
<p>A legacy alternative to locale. When this value is accessed,
  underscores will be replaced by dashes in the returned value.</p>


<h3 id="model.querystring">model.queryString [<em>query</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>query</td></tr>
<tr><td>Values</td>
    <td>A query string in the
        <a href="simple-query-language-reference.html">Simple Query Language</a>.
        It is combined with <a href="#model.filter">model.filter</a>.
        See the <a href="query-language-reference.html#userquery">userQuery</a>
        operator for how to combine with YQL.
        Can also be used without YQL.</td></tr>
<tr><td>Default</td><td><em>Not set</em></td></tr>
</table>


<h3 id="model.restrict">model.restrict [<em>restrict</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>restrict</td></tr>
<tr><td>Values</td><td>A comma delimited list of document type names.</td></tr>
<tr><td>Default</td><td><em>Query unrestricted</em></td></tr>
</table>
<p>
  The document types to restrict the query to when different document types share the same content cluster,
  see <a href="../schemas.html#multiple-schemas">multiple schemas</a>.
</p>


<h3 id="model.searchPath">model.searchPath [<em>path</em>]</h3>

<table class="table table-striped">
<tr><td>Alias</td><td>searchpath</td></tr>
<tr><td>Values</td><td><ul>
      <li>searchpath::ELEMENT [';' ELEMENT]*</li>
      <li>ELEMENT::NODE ['/' GROUP]</li>
      <li>NODE::EXP [',' EXP]*</li>
      <li>EXP::NUM | RANGE</li>
      <li>GROUP::NUM</li>
      <li>RANGE::'['NUM ',' NUM ' &gt;'</li>
  </ul></td></tr>
<tr><td>Default</td><td><em>All nodes in one group chosen by load balancing.</em></td></tr>
</table>

<p>Specification of which content nodes a query should be sent to.
This is useful for debugging/monitoring.</p>

<p>Examples:
Note that in a content cluster with flat distribution we have 1 implicit group
<ul>
  <li>'7/3' = node 7, group 3.</li>
  <li>'7/' = node 7, any group.</li>
  <li>'7,1,9/0' = nodes 1,7 and 9, group 0.</li>
  <li>'1,[3,9&gt;/0' = nodes 1,3,4,5,6,7,8, group 0.</li>
</ul>


<h3 id="model.sources">model.sources [<em>search, sources</em>]</h3>

<table class="table table-striped">
<tr><td>Alias</td><td>search, sources</td></tr>
<tr><td>Values</td><td>A comma separated list of content cluster names or other source names</td></tr>
<tr><td>Default</td><td><em>Query unrestricted</em></td></tr>
</table>
<p>
  The names of the sources to query, e.g. one or more content clusters and/or federated sources -
  see <a href="../schemas.html#content-cluster-mapping">content cluster mapping</a>.
</p>


<h3 id="model.type">model.type [<em>type</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>type</td></tr>
<tr><td>Values</td><td>all, weakAnd, any, phrase, tokenize, web, yql  -
  refer to <a href="simple-query-language-reference.html">simple query language reference</a>.
  Also see <a href="query-language-reference.html#userinput">YQL grammar</a>.
<tr><td>Default</td><td>all</td></tr>
</table>
<p>
Selects the query language syntax of the
<a href="#model.querystring">model.queryString</a> parameter.
</p>



<h2 id="ranking">Ranking</h2>

<h3 id="ranking.location">ranking.location</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>location</td></tr>
<tr><td>Values</td><td>See <a href="../geo-search.html">Geo search</a></td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>
<p>
  Point (two-dimensional location) to use as base for location ranking.
</p>
  {% include deprecated.html content=" Deprecated in favor of adding a
  <a href='query-language-reference.html#geolocation'>geoLocation</a>
  item to the query tree.
  Use inside a <a href='query-language-reference.html#rank'>rank</a> operator
  if it should be used only for ranking)."%}


<h3 id="ranking.features">ranking.features.<em>featurename</em> [<em>rankfeature.</em>featurename]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>rankfeature.featurename</td></tr>
<tr><td>Values</td><td>Any string</td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>
<p>
Set a rank feature to a value. This works for any key name <code>query(anyname)</code> (query features),
and also as a way to override all existing (match and document) features.
Example: <em>query=foo&amp;ranking.features.query(userage)=42&amp;ranking.features.fieldMatch(title)=0.65</em>
</p>


<h3 id="ranking.listFeatures">ranking.listFeatures [<em>rankfeatures</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>rankfeatures</td></tr>
<tr><td>Values</td><td>boolean</td></tr>
<tr><td>Default</td><td>false</td></tr>
</table>
<p>
Set to true to request <em>all</em>
<a href="schema-reference.html#rank-features">rank-features</a> to be calculated and returned.
The rank features will be returned in the summary field <em>rankfeatures</em>.
This option is typically used for MLR training, should not to be used for production.
</p>


<h3 id="ranking.profile">ranking.profile [<em>ranking</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>ranking</td></tr>
<tr><td>Values</td><td>Any rank profile name</td></tr>
<tr><td>Default</td><td><code>default</code></td></tr>
</table>
<p>
Sets <a href="schema-reference.html#rank-profile">rank profile</a>
to use for assigning rank scores for documents.
The default rank profile will be used for back-ends which does not have the given rank profile.
</p>


<h3 id="ranking.properties">ranking.properties.<em>propertyname</em> [<em>rankproperty.propertyname</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>rankproperty.propertyname</td></tr>
<tr><td>Values</td><td>Any string</td></tr>
<tr><td>Default</td><td><em>None</em></td></tr>
</table>
<p>
Set a <a href="schema-reference.html#rank-properties">rank property</a>
that is passed to, and used by a feature executor for this query.
Example: <em>query=foo&amp;ranking.properties.dotProduct.X={a:1,b:2}</em>
</p>


<h3 id="ranking.softtimeout">ranking.softtimeout</h3>
<p>
By default, the hits available are returned on <a href="#timeout">timeout</a>.
To return no hits at timeout instead, set <em>ranking.softtimeout.enable=false</em>.
Softtimeout use <em>ranking.softtimeout.factor</em> of the <a href="#timeout">timeout</a>, 70% default.
The rest of the time budget is spent on later ranking phases.
The factor is adaptive, per rank profile - the factor is adjusted based on remaining time after all ranking phases,
unless overridden in the query using <em>ranking.softtimeout.factor</em>.
Example: query with 500ms timeout, use 300ms in first-phase ranking:
</p>
<pre>&amp;ranking.softtimeout.enable=true&amp;ranking.softtimeout.factor=0.6&amp;timeout=0.5</pre>
<p>
Read more about softtimeout in  <a href="../graceful-degradation.html">Coverage degradation</a> documentation.
</p>


<h3 id="ranking.softtimeout.enable">ranking.softtimeout.enable</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>boolean</td></tr>
<tr><td>Default</td><td>true</td></tr>
</table>


<h3 id="ranking.softtimeout.factor">ranking.softtimeout.factor</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>[0 - 1]</td></tr>
<tr><td>Default</td><td>0.7</td></tr>
</table>


<h3 id="ranking.sorting">ranking.sorting [<em>sorting</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>sorting</td></tr>
<tr><td>Values</td><td>A valid <a href="sorting.html">sort specification</a></td></tr>
<tr><td>Default</td><td>None - order by relevance</td></tr>
</table>
<p>
A specification of how to sort the result.
Fields you want to sort on must be stored as document attributes in the index structure
by adding <a href="schema-reference.html#attribute">attribute</a> to the indexing statement.
</p>


<h3 id="ranking.freshness">ranking.freshness</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td><code>[integer]</code>, an absolute time in seconds since epoch, or <code>now-[number]</code>, to use a time [integer] seconds into the past, or <code>now</code> to use the current time</td></tr>
<tr><td>Default</td><td>None - use the current time on each node.</td></tr>
</table>
<p>
Sets the time which will be used as <em>now</em> during execution.
</p>


<h3 id="ranking.queryCache">ranking.queryCache</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>boolean</td></tr>
<tr><td>Default</td><td>false</td></tr>
</table>
<p>
  Turns query cache on or off. Query is a two-phase process.
  If the query cache is on, the query is stored on the content nodes between the first and second phase,
  saving network bandwidth and also query setup time, at the expense of using more memory.
  It only affects the protocol phase two,
  see <a href="../performance/caches-in-vespa.html">caches in Vespa</a>.
  It does not cache the result, it just saves resources by not forwarding the query twice
  (one for the first protocol phase which is find the best k documents from all nodes,
  to the second phase which is to fill summary data
  and potentially ranking features listed in summary-features in the ranking profile).
</p>
<p>
  The <a href="schema-reference.html#summary-features">summary-features</a>
  are re-calculated but this setting avoids sending the query down once more.
  There is little downside of using it,
  and it can save resources and latency in cases where the query tree and query ranking features
  (e.g. tensors used in ranking) are large.
  As this is a protocol optimization, it also works with changing filter,
  it's not cached cross independent queries,
  it's just saving having to send the <span style="text-decoration: underline;">same</span> query twice.
</p>


<h3 id="ranking.rerankCount">ranking.rerankCount</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td></td></tr>
  <tr><td>Values</td><td>integer</td></tr>
  <tr><td>Default</td><td>null</td></tr>
</table>
<p>Specifies the number of hits that should be ranked in the second ranking phase.
  Overrides the <a href="schema-reference.html#rerank-count">rerank-count set in the rank profile</a>.</p>


<h3 id="ranking.matchPhase">ranking.matchPhase</h3>
<p>Settings which control Vespa's behavior during the match phase.
If these are set in the query,
they will override any match-phase setting in the rank profile.</p>
<dt></dt>
<dd>
  <ul>
    <li><a href="#ranking.matchPhase.maxHits">ranking.matchPhase.maxHits</a> the max number of hits that should be generated during the match phase</li>
    <li><a href="#ranking.matchPhase.attribute">ranking.matchPhase.attribute</a> the attribute to limit matches by if more than maxHits hits will be generated</li>
    <li><a href="#ranking.matchPhase.ascending">ranking.matchPhase.ascending</a> whether to keep the documents having the highest (default) or lowest values of the attribute</li>
    <li><a href="#ranking.matchPhase.diversity.attribute">ranking.matchPhase.diversity.attribute</a> the attribute to use to guarantee diversity.</li>
    <li><a href="#ranking.matchPhase.diversity.minGroups">ranking.matchPhase.diversity.minGroups</a> the minimum number of groups grouped by the diversity attribute.</li>
  </ul>
</dd>


<h3 id="ranking.matchPhase.maxHits">ranking.matchPhase.maxHits</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>long</td></tr>
<tr><td>Default</td><td>If sorting and not ranking: max(10000, maxhits+maxoffset).
  Otherwise: <em>none</em>.</td></tr>
</table>
<p>
The max hits the engine should attempt to produce in the match phase on each partition.
If it is determined during matching that many more hits than this will be generated,
the matching will fall back to take the best (highest or lowest) values of the attribute
given by ranking.matchPhase.attribute.
</p><p>
By default, this will be turned on only when sorting is used and grouping is not.
If sorting is used, the primary sort attribute will be used as the match phase attribute
if it has <a href="../attributes.html#fast-search">fast-search</a> set.
In that case the default can be overridden by setting this value explicitly.
</p>


<h3 id="ranking.matchPhase.attribute">ranking.matchPhase.attribute</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>An attribute name</td></tr>
<tr><td>Default</td><td><em>none</em></td></tr>
</table>
<p>
The attribute to decide which documents are a match if the match phase
estimates that there will be more than maxHits matches.
This attribute should have <a href="../attributes.html#fast-search">fast-search</a> set
and should correlate with the order which would be produced by a full evaluation.
</p>


<h3 id="ranking.matchPhase.ascending">ranking.matchPhase.ascending</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>boolean</td></tr>
<tr><td>Default</td><td>false</td></tr>
</table>
<p>
Whether the attribute should be sorted in ascending or descending (default) order,
to select documents to keep as matches.
</p>


<h3 id="ranking.matchPhase.diversity.attribute">ranking.matchPhase.diversity.attribute</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>An attribute name</td></tr>
<tr><td>Default</td><td>none.</td></tr>
</table>
<p>
The attribute to be used for producing the desired
<a href="schema-reference.html#diversity-attribute">diversity</a>.
</p>


<h3 id="ranking.matchPhase.diversity.minGroups">ranking.matchPhase.diversity.minGroups</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>long</td></tr>
<tr><td>Default</td><td>none</td></tr>
</table>
<p>
The minimum number of groups that should be returned from the match phase grouped by the diversity attribute.
Also see <a href="schema-reference.html#diversity-min-groups">min-groups</a>.
</p>



<h2 id="dispatch">Dispatch</h2>

<h3 id="dispatch.topKProbability">dispatch.topKProbability</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>double</td></tr>
<tr><td>Default</td><td><a href="services-content.html#top-k-probability">none</a></td></tr>
</table>
<p>
Probability to use when computing how many hits to fetch from each partition
when merging and creating the final result set.
See <a href="services-content.html#top-k-probability">services</a> for details.
</p>



<h2 id="presentation">Presentation</h2>

<h3 id="presentation.bolding">presentation.bolding [<em>bolding</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>bolding</td></tr>
<tr><td>Values</td><td>boolean</td></tr>
<tr><td>Default</td><td>true</td></tr>
</table>
<p>
Whether or not to bold query terms in <a href="schema-reference.html">schema</a>
fields defined with <a href="schema-reference.html#bolding">bolding: on</a>
or <a href="schema-reference.html#summary">summary: dynamic</a>.
</p>


<h3 id="presentation.format">presentation.format [<em>format</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>format</td></tr>
<tr><td>Values</td><td>
  <table class="table table-striped">
    <tr>
      <td><em>No value</em> or <code><a href="default-result-format.html">default</a></code></td>
      <td>The default, builtin JSON format</td>
    </tr>
    <tr>
      <td><code><a href="default-result-format.html">json</a></code></td>
      <td>Builtin JSON format</td>
    </tr>
    <tr>
      <td><code>xml</code></td>
      <td>
        Builtin XML format.
        {% include deprecated.html content="See
        <a href='../vespa8-release-notes.html'>deprecations</a>."%}</td>
    </tr>
    <tr>
      <td><code><a href="page-result-format.html">page</a></code></td>
      <td>
        XML format which is suitable for use with <a href="../page-templates.html">page templates</a>.
        {% include deprecated.html content="See
        <a href='../vespa8-release-notes.html'>deprecations</a>."%}</td>
    </tr>
    <tr>
      <td><em>Any other value</em></td>
      <td>A custom <a href="../result-rendering.html">result renderer</a> supplied by the application
        </tr>
  </table>
  
</td>
</tr>
<tr><td>Default</td><td>default</td></tr>
</table>


<h3 id="presentation.summary">presentation.summary [<em>summary</em>]</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>summary</td></tr>
<tr><td>Values</td><td>
  The name of the <a href="../document-summaries.html#summary-classes-in-queries">summary class</a>
  used to select fields in results.
</td></tr>
<tr><td>Default</td><td>The default summary class of the schema.</td></tr>
</table>


<h3 id="presentation.template">presentation.template</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Any id specification of a deployed page template.</td></tr>
<tr><td>Default</td><td></td></tr>
</table>
<p>
The id of the page template to use for this result. This should be used with the
<a href="page-result-format.html">page</a> result format.
</p>


<h3 id="presentation.timing">presentation.timing</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>boolean</td></tr>
<tr><td>Default</td><td>false</td></tr>
</table>
<p>
Whether a result renderer should try to add optional timing information
to the rendered page.
</p>

<h3 id="presentation.format.tensors">presentation.format.tensors</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td>format.tensors</td></tr>
  <tr><td>Values</td><td>short, long</td></tr>
  <tr><td>Default</td><td>long</td></tr>
</table>
<p>
  Whether tensors should be rendered in the long, regular format, or in the short form appropriate for their type
  (if any), see the <a href="document-json-format.html#tensor">tensor JSON format</a>.
</p>


<h2 id="grouping-and-aggregation">Grouping and Aggregation</h2>

<h3 id="grouping-select">select</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>A valid grouping specification.</td></tr>
<tr><td>Default</td><td>No grouping</td></tr>
</table>
<p>
Requests specific multi-level result set statistics and/or hit groups to be returned in the result.
Fields you want to retrieve statistics or hit groups for must be stored as document attributes
in the index structure by adding attribute to the indexing statement.
See the <a href="../grouping.html">grouping guide</a>.
</p>


<h3 id="collapsefield">collapsefield</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Any document summary field name</td></tr>
<tr><td>Default</td><td>No field collapsing</td></tr>
</table>
<p>
Collapse (i.e. aggregate) results using this field.
Collapsing is run in the container, not content node level.
Define a <em>collapsefield</em> to remove duplicates if the corpus has few duplicates -
this is more efficient than using <a href="#select">grouping</a>.
Otherwise, use grouping.
</p>


<h3 id="collapsesize">collapsesize</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>A positive integer</td></tr>
<tr><td>Default</td><td>1</td></tr>
</table>
<p>The number of hits to keep in each collapsed bucket</p>


<h3 id="collapse.summary">collapse.summary</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td></td></tr>
  <tr><td>Values</td><td>A valid name of a document summary class.</td></tr>
  <tr><td>Default</td><td>Use default summary or attributes.</td></tr>
</table>
<p>Use this summary class to fetch the field used for collapsing.</p>



<h2 id="geographical-searches">Geographical Searches</h2>
<p>
When a position is used in a query, a distance to this position is calculated and returned -
see the rendering <a href="document-json-format.html#position">reference</a> and
<a href="../geo-search.html">geo search</a> for details.
</p>
  {% include deprecated.html content="Adding a <a href='query-language-reference.html#geolocation'>geoLocation</a>
  item to the query tree is the preferred and uniform way to inject the position, radius, and attribute field,
  so the pos.ll, pos.radius, pos.bb and pos.attribute request parameters below are deprecated."%}


<h3 id="pos.ll">pos.ll</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>pos.ll</td></tr>
<tr><td>Values</td>
  <td>Position given in latitude and longitude - example: <em>S22.4532;W123.9887</em>
    Refer to <a href="document-json-format.html#position">position field</a>
    for format specification.</td>
</tr>
<tr><td>Default</td><td>None</td></tr>
</table>


<h3 id="pos.radius">pos.radius</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>pos.radius</td></tr>
<tr><td>Values</td><td>
  Radius of the circle used for filtering.
  Valid units of measurement are <code>km</code>, <code>m</code> and <code>mi</code>. Examples:
  <ul>
    <li>pos.radius=1609.344m</li>
    <li>pos.radius=1mi</li>
    <li>pos.radius=1.609344km</li>
  </ul>
  One can also specify just a number (internal units, micro-degrees), but this is not recommended.
  Any negative number is interpreted as an "infinite" radius, letting any geographical position at all
  match the filter.
</td></tr>
<tr><td>Default</td><td>50km</td></tr>
</table>


<h3 id="pos.bb">pos.bb</h3>
<table class="table table-striped">
<tr><td>Alias</td><td>pos.bb</td></tr>
<tr><td>Values</td><td>
  {% include deprecated.html content="pos.bb is deprecated, do not use"%}
  Bounding box for positions, given as latitude and longitude boundaries.
  The four boundaries must be specified as N, S, E, W, with degrees as a decimal fraction.
  Degrees south of the equator or west of Greenwich are negative numbers.
  S/W/N/E can be in any order, and be specified in lower or upper case,
  Restrictions: N>=S and E>=W. Examples:
  <ul>
    <li>n=37.44899,s=37.3323,e=-121.98241,w=-122.06566</li>
    <li>s=40.183868,w=-74.819519,n=40.248291,e=-74.728798</li>
  </ul>
</td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>


<h3 id="pos.attribute">pos.attribute</h3>
<table class="table table-striped">
  <tr><td>Alias</td><td>pos.attribute</td></tr>
  <tr><td>Values</td><td>Any attribute that has zcurve encoded positions as a long attribute.</td></tr>
  <tr><td>Default</td><td>Random choice among the ones declared as position in the schema.</td></tr>
</table>
<p>
Which attribute to use for the position. Can be both single-valued or
<a href="../schemas.html#field">array</a>.
</p>



<h2 id="semantic-rules">Semantic Rules</h2>
<p>
Refer to <a href="semantic-rules.html">semantic rules</a>.
</p>

<h3 id="rules.off">rules.off</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Boolean</td></tr>
<tr><td>Default</td><td>True</td></tr>
</table>
<p>Turn rule evaluation off for this query</p>


<h3 id="rules.rulebase">rules.rulebase</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>String</td></tr>
<tr><td>Default</td><td>A rule base name</td></tr>
</table>
<p>The name of the rule base to use for these queries</p>


<h3 id="tracelevel.rules">tracelevel.rules</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>int</td></tr>
<tr><td>Default</td><td>1-5 (?)</td></tr>
</table>
<p>
The amount of rule evaluation trace output to show, higher number means more details.
This is useful to see a trace from rule evaluation
without having to see trace from all other searchers at the same time.
</p>



<h2 id="other">Other</h2>

<h3 id="recall">recall</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Any allowed collection of recall terms.
  <a href="../learning-to-rank.html#collecting-features-for-training">Example</a>.</td></tr>
<tr><td>Default</td><td>No recall</td></tr>
</table>
<p>
Sets a recall parameter to be combined with the query.
This is identical to <a href="#model.filter">filter</a>,
except that recall terms are not exposed to the ranking framework and thus not ranked.
As such, one can not use unprefixed terms; they must either be positive or negative.
</p>


<h3 id="user">user</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>A string</td></tr>
<tr><td>Default</td><td>None</td></tr>
</table>
<p>
The id of the user making the query. The contents of the argument are made available to the search chain,
but it triggers no features in Vespa apart from being propagated to the access log.
</p>


<h3 id="hitcountestimate">hitcountestimate</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Boolean</td></tr>
<tr><td>Default</td><td>False</td></tr>
</table>
<p>Make this an estimation query.
No hits will be returned, and total hit count will be set to an estimate of what executing
the query as a normal query would give.
</p>

<h3 id="metrics.ignore">metrics.ignore</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Boolean</td></tr>
<tr><td>Default</td><td>False</td></tr>
</table>
<p>Ignore metric collection for this query request, useful for warm up queries</p>

<h3 id="weakAnd.replace">weakAnd.replace</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>Boolean</td></tr>
<tr><td>Default</td><td>False</td></tr>
</table>
<p>Replace all instances of OR in the query tree with weakAnd.</p>

<h3 id="wand.hits">wand.hits</h3>
<table class="table table-striped">
<tr><td>Alias</td><td></td></tr>
<tr><td>Values</td><td>An integer</td></tr>
<tr><td>Default</td><td>100</td></tr>
</table>
<p>
  Used in combination with <a href="#weakAnd.replace">weakAnd.replace</a>. 
  Sets the targetHits of the new weakAnds to the specified value.
</p>
