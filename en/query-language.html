---
# Copyright Yahoo. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root.
title: "Vespa Query Language - YQL"
redirect_from:
- /documentation/query-language.html
---

<p>
Vespa accepts unstructured human input and structured queries for application logic separately,
then combines them into a single data structure for executing.
Human input is parsed heuristically, while application queries are formulated in YQL.
</p><p>
A simple query URL looks like:
</p>
<pre>
http://myhost.mydomain.com:8080/search/?yql=select%20%2A%20from%20sources%20%2A%20where%20text%20contains%20%22blues%22%3B
</pre>
<p>In other words, <em>yql</em> contains:</p>
<pre class="urlunencode" oncopy="">
select%20%2A%20from%20sources%20%2A%20where%20text%20contains%20%22blues%22%3B
</pre>
<p>
This matches all documents where the field named <em>text</em> contains the word <em>blues</em>.
</p><p>
This document has examples and guides for how to use search operators as found in the
<a href="reference/query-language-reference.html">query language reference</a>.
</p><p>
Example queries:
</p>
<table class="table">
  <thead></thead><tbody>
    <tr>
      <th>Ordering</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where default contains \"bad\" order by year desc;"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Grouping</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where default contains \"bad\" | all(group(year) each(output(sum(duration))));"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Pagination</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where default contains \"bad\" limit 2 offset 1;"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Numeric</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where year > 2000;"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Boolean</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where alive = true;"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Phrase</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where artist contains phrase(\"michael\", \"jackson\");"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Timeout</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where default contains \"bad\" timeout 100;"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Regexp</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where title matches \"mado[n]+a\";"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Count</th>
      <td>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources music where true;"}' \
    http://localhost:8080/search/
</pre>
      </td>
    </tr><tr>
      <th>Map</th>
      <td>
        <p id="map"></p>
<pre>
$ curl -H "Content-Type: application/json" \
    --data '{"yql" : "select * from sources * where my_map contains sameElement(key contains \"Coldplay\", weight > 10);"}' \
    http://localhost:8080/search/

field my_map type map&lt;string, int&gt; {
    indexing: summary
    struct-field key   { indexing: attribute }
    struct-field value { indexing: attribute }
}
</pre>
      </td>
    </tr>
  </tbody>
</table>


<h2 id="query-examples">Query examples</h2>
<p>
  <button class="is-small"><span class="d-icon is-small d-arrowhead-down"></span></button> to expand queries.
</p>

<p><a class="docsearch-x">select * from doc where true</a></p>
<p>
  Select all documents from the "doc" source.
</p>

<p><a class="docsearch-x">select * from doc where default contains "ranking"</a></p>
<p>
  Find all documents matching "ranking" from the "doc" source.
</p>

<p><a class="docsearch-x">select * from doc where true order by term_count desc</a></p>
<p>
  Select all documents from the "doc" source, order by number of terms in the document, descending.
</p>

<p><a class="docsearch-x">select * from doc where true limit 0 |
  all(
    group( fixedwidth(term_count,100) )
    each( output( avg(term_count) ) )
  )</a></p>
<ul>
  <li>Select all documents from the "doc" source.</li>
  <li>Group by term count in buckets of 100, display average term count per bucket.</li>
  <li>Note "limit 0": This will return 0 regular hits, hence only the grouping result.</li>
</ul>



<style>
.hidepre { display: none; }
</style>

<script>
  function generateQueryExamples () {
    let elements = document.getElementsByClassName("docsearch-x");
    for (let anchor of elements) {
      generateQuery(anchor);
    }
  }

  function generateQuery(anchor) {

    // Create expand-button with icon, with an hr spacing in front
    let expand = document.createElement("button");
    expand.classList.add("is-small");
    expand.style.marginRight = "20px";
    let spanNode = document.createElement("span");
    spanNode.classList.add("d-icon", "is-small", "d-arrowhead-down");
    expand.appendChild(spanNode);
    let hr = document.createElement("hr");
    anchor.parentElement.insertBefore(hr, anchor);

    // Create link to doc search
    anchor.parentElement.insertBefore(expand, anchor);
    anchor.setAttribute("href", encodeURI("https://doc-search.vespa.oath.cloud/search/?yql=" + anchor.innerText));

    // Create hidden pre with curl query
    let preNode = document.createElement("pre");
    preNode.classList.add("hidepre");
    preNode.innerText = "$ curl --data-urlencode 'yql=" + anchor.innerText + "' \\\n"
      + "  https://doc-search.vespa.oath.cloud/search/";
    anchor.parentElement.insertBefore(preNode, anchor.nextSibling);

    // Toggle pre view from button
    expand.addEventListener("click", function () { anchor.nextSibling.classList.toggle("hidepre"); });
  }

  document.addEventListener("DOMContentLoaded", generateQueryExamples);
</script>

<script src="/js/copy_urlencoded.js"></script>
